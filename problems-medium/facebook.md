Facebook connects billions of users through social networking requiring scalable feed generation, content delivery, and real-time interactions, functional requirements including creating posts with text, photos, videos, sharing and commenting, liking and reacting, friend connections and groups, news feed showing relevant content, notifications for interactions, search for people and content, messaging, live video, stories, and events, architecture using API Gateway routing requests, User Service managing profiles and relationships, Post Service handling content creation, Feed Service generating personalized feeds, Notification Service alerting users, Messaging Service for chat, Media Service processing photos and videos, Search Service indexing content, and Analytics Service tracking engagement, data models including User with profile information, friend list, privacy settings, preferences, Post with author, content, media URLs, timestamp, visibility, reactions count, Comment nested with replies, Like linking user to post/comment, and Friendship representing bidirectional connections with status (pending, accepted, blocked), storage using MySQL for structured user data with master-slave replication, Cassandra for posts and comments with high write throughput and time-series access patterns, Graph Database (TAO) for social graph storing friend connections enabling traversals, Object Storage (Haystack) for photos and videos with custom optimization for small files, Memcached for caching everything reducing database load, and HDFS for archival and analytics, social graph storage implementing Adjacency List storing friends per user in denormalized format enabling fast friend lookup, TAO (The Associations and Objects) Facebook's custom graph store caching associations with write-through and read-through patterns, Sharding by user_id distributing load across databases, and Replication across datacenters for fault tolerance and geographic distribution, feed generation using Fan-Out on Write where post creation triggers writes to followers' feeds precomputing timelines trading write amplification for fast reads, Fan-Out on Read generating feed at read time mixing posts from friends suitable for users with many followers like celebrities, or Hybrid Approach using fan-out for most users but read-time for high-follower accounts balancing latency and storage, ranking algorithm using EdgeRank (now more complex ML models) scoring posts based on affinity (relationship strength), weight (engagement type like comment > like), and time decay (recency), personalization learning from user behavior (clicks, time spent, shares) predicting engagement, content diversity preventing filter bubbles showing varied sources, and Real-Time Signals incorporating trending topics and breaking news, posts and comments implementing Write Path where user creates post, Post Service validates and stores in database, generates media thumbnails and processes videos, performs fan-out writing to followers' feeds or queuing for background processing, and triggers notifications to mentioned users, Read Path where user requests feed, Feed Service queries precomputed timeline from cache, fetches missing posts from database, ranks and filters based on algorithm, hydrates with user data and media URLs, and returns paginated results, media handling using Photo Upload with client-side compression, server-side processing generating multiple resolutions, storing originals in cold storage, caching popular photos in hot storage, and CDN distribution globally, Video Processing transcoding to multiple formats and bitrates, thumbnail extraction, adaptive streaming preparation, content moderation scanning for violations, and Progressive Upload allowing large files in chunks, notifications implementing Push Notifications via mobile OS (FCM, APNS), In-App Notifications polling or WebSocket, Email Notifications for important updates, Aggregation combining similar notifications (10 people liked your post), Priority levels (mentions vs likes), and User Preferences controlling notification types, real-time features using WebSocket for online presence and instant updates, Long Polling fallback for unsupported clients, Presence System tracking who's online with heartbeats, and Event Streams (Scribe) logging all actions for real-time processing, messaging service (separate from main feed) implementing End-to-End Encryption for privacy, Message Sync across devices using message queue, Read Receipts and typing indicators, Group Chats with membership management, Media Sharing with preview generation, and Voice/Video Calls using WebRTC, search implementing Inverted Index in Elasticsearch indexing posts, users, pages, events, Typeahead suggesting as user types with prefix matching, Faceted Search filtering by type, date, location, person, Ranking combining relevance, recency, and social signals, and Privacy Filtering respecting visibility settings, privacy and security using Access Control enforcing visibility settings (public, friends, custom), Encryption for sensitive data in transit and at rest, Content Moderation using AI detecting violations with human review, Two-Factor Authentication protecting accounts, and GDPR Compliance with data portability and deletion, scalability through Geographic Distribution with datacenters worldwide serving regional users, Horizontal Scaling of stateless services adding instances, Database Sharding partitioning by user or content ID, Caching at every layer (browser, CDN, application, database), Async Processing for feed generation, notifications, media processing using queues, and Load Balancing distributing traffic across servers, feed optimization using Cached Timelines storing precomputed feeds in Memcached with TTL, Incremental Updates appending new posts without full regeneration, Negative Caching storing non-existent results preventing repeated queries, and Pagination limiting feed size loading more on scroll, groups and pages extending data model with Group entity having members, posts, permissions, Page with followers, scheduled posts, insights, implementing separate feeds for groups aggregating member posts, page posts appearing in followers' feeds, and events with attendees and updates, live video using Video Ingestion via RTMP from broadcaster, Transcoding to adaptive formats in real-time, CDN Distribution with edge caching, Chat Integration during stream, Recording for replay, and Notification to followers when going live, stories implementing Ephemeral Content disappearing after 24 hours, Viewer Tracking showing who watched, Reactions during viewing, Vertical Format optimized for mobile, Swipeable Navigation between friends' stories, and Highlights allowing permanent saving, advertising serving Ads mixed into feed with targeting based on demographics, interests, behaviors, Auction-Based bidding for ad slots, Frequency Capping limiting exposure, Attribution tracking conversions, and Privacy-Preserving using aggregated data, metrics tracking Daily/Monthly Active Users showing platform health, Engagement Rate (likes, comments, shares per post), Time Spent on platform, Content Velocity (posts per second), Feed Load Time and error rates, Notification Click-Through Rate, and Revenue per user, content moderation using Automated Detection with ML models flagging violations, Human Review for flagged content, Community Reporting allowing user reports, Appeals Process for mistakes, and Proactive Scanning especially for harmful content, challenges including News Feed Quality balancing relevance, diversity, engagement with click-bait prevention, Fake News and misinformation requiring fact-checking partnerships, Privacy Concerns with user data requiring transparent controls, Scale handling billions of users and trillions of posts demanding extreme optimization, Real-Time Processing for instant feed updates and notifications, and Data Center Failures requiring multi-region redundancy, modern features including Reels short-form video competing with TikTok, Marketplace for buying and selling, Gaming instant games and cloud gaming, Virtual Reality social spaces in Metaverse, AI-Powered Features like automatic alt-text and translation, and Creator Tools monetization options for content creators, infrastructure innovations using Custom Hardware designing servers optimized for workload, Open Compute Project sharing designs, Software Optimization with custom kernels and networking, and Machine Learning Infrastructure with PyTorch and recommendation systems, ensuring reliability through Multi-Region Active-Active deployment, Automated Failover and traffic shifting, Chaos Engineering testing failure scenarios, Comprehensive Monitoring with real-time dashboards, and Incident Response with on-call rotation, making Facebook one of largest and most complex distributed systems ever built serving social connections for significant portion of global population with continuous evolution balancing growth, engagement, privacy, and societal impact.
