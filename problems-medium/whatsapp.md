Designing WhatsApp requires building a real-time messaging system that handles billions of messages daily supports one-on-one and group chats provides end-to-end encryption ensures message delivery and supports multimedia sharing. Core requirements include sending and receiving text messages instantly supporting group chats with many participants sending images videos and documents showing online status and last seen delivering messages reliably even when recipients are offline supporting read receipts and typing indicators providing end-to-end encryption and syncing messages across multiple devices. The system architecture includes client applications on mobile and web API gateway for routing requests chat service for message handling user service for authentication and profiles presence service for online status group service for group management media service for file uploads and downloads notification service for push notifications and database layer with appropriate data stores. For real-time communication use WebSocket connections for persistent bidirectional communication between clients and servers allowing instant message delivery. When users are offline use push notifications via APNs for iOS and FCM for Android. The message flow involves sender client sending message through WebSocket to chat service chat service validating and storing message in database chat service forwarding to recipient if online or queuing for later delivery recipient acknowledging receipt and chat service sending delivery receipt to sender. For message storage use a NoSQL database like Cassandra for horizontal scalability and high write throughput partitioned by user_id to keep all messages for a user together. Store messages with schema like message_id sender_id recipient_id content timestamp is_delivered is_read. For group chats maintain a separate table with group_id member_ids and handle message fan-out where one message is replicated to all group members. Media handling involves clients uploading files to media service media service storing files in object storage like S3 media service returning file URL including URL in message metadata and recipients downloading files on-demand. For presence service track online status using heartbeat mechanism where clients send periodic pings update last_seen timestamp and use Redis for fast reads of presence data. End-to-end encryption ensures only sender and recipient can read messages using Signal Protocol where keys are exchanged between clients and messages are encrypted on sender device and decrypted on recipient device with server only seeing encrypted data. For scalability use microservices architecture with each service scaled independently implement database sharding based on user_id use message queues for async processing use CDN for media delivery and deploy across multiple regions. Additional features include message search using Elasticsearch voice and video calls using WebRTC status updates similar to stories backup and restore using cloud storage and disappearing messages with automatic deletion.